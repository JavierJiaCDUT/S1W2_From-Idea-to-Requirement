<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Product Requirements Management Learning Application</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Chosen Palette: Calm Harmony (Warm neutrals like beige/off-white, slate/taupe text, and a muted teal/soft blue accent) -->
    <!-- Application Structure Plan: A thematic, interactive learning module with top-level navigation (Overview, User Stories, Gathering, Management, PMBOK). This structure transforms the linear report into an engaging, non-linear experience. Users can actively practice concepts (e.g., building a user story, sorting requirements) and synthesize information through comparative visualizations (e.g., a chart comparing gathering methods). This active learning approach is more effective for educational content than a passive, scrolling page, promoting deeper understanding and retention. -->
    <!-- Visualization & Content Choices:
- Intro -> HTML/CSS Flow Diagram: To visually map the core process from 'Idea' to 'Value' with hover interactions for engagement.
- User Story Template -> Interactive Form: To provide hands-on practice in writing user stories, which is more effective than passive reading.
- ✨User Story Optimization Suggestions✨ -> LLM Integration: To provide AI-powered feedback on user-generated stories, reinforcing INVEST principles.
- 3C Principles -> Donut Chart (Chart.js): To offer a simple visual metaphor of the three equal components.
- INVEST Principles -> Interactive Accordion: To present detailed information in a compact, user-controlled format.
- Gathering Methods -> Interactive Cards + Bar Chart (Chart.js): To allow both detailed exploration of each method and a high-level visual comparison based on data breadth vs. depth, aiding in selection.
- ✨Interview Question Generator✨ -> LLM Integration: To generate interview questions based on user input, simulating a real-world demand gathering task.
- Requirement Categories -> Interactive Sorting Game: To test and reinforce understanding through active recall and application.
- Prioritization -> HTML/CSS Matrix: To visually explain the concept of prioritization in an intuitive layout.
- PMBOK -> Two-Column Layout: To clearly present and compare the related performance domains.
- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. All visuals are implemented with Chart.js (Canvas) or standard HTML/CSS/JS. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <style>
        body {
            font-family: 'Noto Sans SC', sans-serif;
        }
        .nav-btn {
            transition: all 0.3s ease;
        }
        .nav-btn.active {
            background-color: #0d9488; /* teal-600 */
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .content-section {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }
        .content-section.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 350px;
        }
        .interactive-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }
        .interactive-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .sortable-item {
            cursor: grab;
            transition: background-color 0.2s;
        }
        .drop-zone {
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }
        .drop-zone.over {
            background-color: #ccfbf1; /* teal-100 */
            border-color: #14b8a6; /* teal-500 */
        }
        .flow-step {
            position: relative;
            transition: all 0.3s ease;
        }
        .flow-step .tooltip {
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .flow-step:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body class="bg-stone-50 text-stone-800">

    <div class="container mx-auto p-4 md:p-8">
        
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-teal-700">Product Requirements Management: The Journey from Idea to Value</h1>
            <p class="mt-2 text-stone-600">An interactive learning guide for transforming innovation into reality</p>
        </header>

        <nav class="flex flex-wrap justify-center gap-2 md:gap-4 mb-8">
            <button data-target="overview" class="nav-btn active py-2 px-4 bg-white rounded-lg shadow-sm font-semibold text-stone-700">Overview</button>
            <button data-target="user-story" class="nav-btn py-2 px-4 bg-white rounded-lg shadow-sm font-semibold text-stone-700">User Stories</button>
            <button data-target="gathering" class="nav-btn py-2 px-4 bg-white rounded-lg shadow-sm font-semibold text-stone-700">Requirements Gathering</button>
            <button data-target="management" class="nav-btn py-2 px-4 bg-white rounded-lg shadow-sm font-semibold text-stone-700">Requirements Management</button>
            <button data-target="pmbok" class="nav-btn py-2 px-4 bg-white rounded-lg shadow-sm font-semibold text-stone-700">PMBOK Connection</button>
        </nav>

        <main class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
            
            <section id="overview" class="content-section active">
                <h2 class="text-2xl font-bold text-teal-600 mb-4">The Journey from Idea to Value</h2>
                <p class="mb-6 text-stone-600">Every great product starts with an 'idea,' but transforming vague inspirations into products that truly solve problems and create value requires a systematic and rigorous process. This section will guide you through the core stages of this journey. Innovation isn't born out of thin air; it typically stems from a deep understanding of problems and opportunities. Hover over the flowchart below to explore the meaning of each step.</p>
                <div class="flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4 text-center text-white font-bold">
                    <div class="flow-step w-32 h-32 flex items-center justify-center bg-teal-500 rounded-full shadow-md">
                        Idea
                        <div class="tooltip absolute -top-12 w-48 p-2 bg-stone-700 text-white text-sm rounded-md shadow-lg">The spark of innovative ideas, which can come from anywhere.</div>
                    </div>
                    <div class="text-2xl text-stone-400 font-light">→</div>
                    <div class="flow-step w-32 h-32 flex items-center justify-center bg-amber-500 rounded-full shadow-md">
                        Pain Point
                        <div class="tooltip absolute -top-16 w-48 p-2 bg-stone-700 text-white text-sm rounded-md shadow-lg">Discovering unmet user needs, inefficient processes, or poor existing product experiences. This is the source of innovation.</div>
                    </div>
                    <div class="text-2xl text-stone-400 font-light">→</div>
                    <div class="flow-step w-32 h-32 flex items-center justify-center bg-sky-500 rounded-full shadow-md">
                        Requirement
                        <div class="tooltip absolute -top-12 w-48 p-2 bg-stone-700 text-white text-sm rounded-md shadow-lg">Transforming pain points into clear, actionable product requirements.</div>
                    </div>
                    <div class="text-2xl text-stone-400 font-light">→</div>
                    <div class="flow-step w-32 h-32 flex items-center justify-center bg-emerald-500 rounded-full shadow-md">
                        Value
                        <div class="tooltip absolute -top-12 w-48 p-2 bg-stone-700 text-white text-sm rounded-md shadow-lg">Creating real value for users and businesses through product features.</div>
                    </div>
                </div>
            </section>

            <section id="user-story" class="content-section">
                <h2 class="text-2xl font-bold text-teal-600 mb-4">User Stories: The Smallest Deliverable Unit of Requirements</h2>
                <p class="mb-6 text-stone-600">In agile development, user stories are the core way to describe product functionality. They focus on the user's perspective, ensuring we always prioritize creating value for the user, rather than just implementing features. This section will help you master user story writing and core principles through interactive exercises.</p>
                <div class="grid md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-xl font-semibold mb-3">User Story Builder</h3>
                        <p class="text-sm text-stone-500 mb-4">Try filling out the form below to build your own user story.</p>
                        <div class="space-y-4">
                            <div>
                                <label for="user-role" class="font-medium">As a [User Role]</label>
                                <input type="text" id="user-role" placeholder="e.g., Student" class="mt-1 w-full p-2 border border-stone-300 rounded-md focus:ring-teal-500 focus:border-teal-500">
                            </div>
                            <div>
                                <label for="user-goal" class="font-medium">I want to [Some Feature]</label>
                                <input type="text" id="user-goal" placeholder="e.g., see my learning progress bar on the course page" class="mt-1 w-full p-2 border border-stone-300 rounded-md focus:ring-teal-500 focus:border-teal-500">
                            </div>
                            <div>
                                <label for="user-value" class="font-medium">So that [Achieve Some Value]</label>
                                <input type="text" id="user-value" placeholder="e.g., clearly understand my learning status and motivate myself" class="mt-1 w-full p-2 border border-stone-300 rounded-md focus:ring-teal-500 focus:border-teal-500">
                            </div>
                        </div>
                        <div id="generated-story" class="mt-6 p-4 bg-teal-50 border-l-4 border-teal-500 text-teal-800 rounded-r-lg min-h-[80px]">
                            <p class="font-semibold">Your generated user story will appear here.</p>
                        </div>
                        <button id="optimize-story-btn" class="mt-4 py-2 px-4 bg-teal-500 text-white font-semibold rounded-lg shadow-md hover:bg-teal-600 transition-colors">✨Get Optimization Suggestions✨</button>
                        <div id="optimization-suggestions" class="mt-4 p-4 bg-blue-50 border-l-4 border-blue-500 text-blue-800 rounded-r-lg hidden">
                            <p class="font-semibold">Optimization Suggestions:</p>
                            <div id="optimization-content" class="mt-2 text-sm"></div>
                            <div id="optimization-loading" class="text-center text-sm text-blue-600 hidden">Generating...</div>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-xl font-semibold mb-3">Core Principles</h3>
                        <div class="grid grid-cols-1 gap-6">
                            <div>
                                <h4 class="font-semibold text-lg mb-2">3C Principles</h4>
                                <div class="chart-container">
                                    <canvas id="3c-chart"></canvas>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-semibold text-lg mb-2">INVEST Quality Standards</h4>
                                <div id="invest-accordion" class="space-y-2"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="gathering" class="content-section">
                <h2 class="text-2xl font-bold text-teal-600 mb-4">Requirements Gathering: The Bridge from Users to Product Managers</h2>
                <p class="mb-6 text-stone-600">Now that we have a good way to describe requirements (user stories), how do we discover these stories? This requires effective requirements gathering methods. Different methods are suitable for different scenarios, some aiming for breadth, others for depth. This section will help you intuitively understand the characteristics and applicability of various methods through interactive cards and charts.</p>
                <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div>
                        <h3 class="text-xl font-semibold mb-3 text-center">Requirements Gathering Method Comparison</h3>
                        <div class="chart-container mx-auto h-[400px] max-h-[450px]">
                            <canvas id="gathering-methods-chart"></canvas>
                        </div>
                    </div>
                    <div id="method-cards-container" class="grid grid-cols-2 sm:grid-cols-3 gap-4">
                    </div>
                </div>

                <div class="mt-8 pt-8 border-t border-stone-200">
                    <h3 class="text-xl font-semibold mb-3">✨Interview Question Generator✨</h3>
                    <p class="text-sm text-stone-500 mb-4">Enter a product topic and target user role, and let AI generate a set of interview questions for you.</p>
                    <div class="space-y-4">
                        <div>
                            <label for="product-topic" class="font-medium">Product Topic</label>
                            <input type="text" id="product-topic" placeholder="e.g., Online Learning Platform" class="mt-1 w-full p-2 border border-stone-300 rounded-md focus:ring-teal-500 focus:border-teal-500">
                        </div>
                        <div>
                            <label for="interview-user-role" class="font-medium">User Role</label>
                            <input type="text" id="interview-user-role" placeholder="e.g., University Student" class="mt-1 w-full p-2 border border-stone-300 rounded-md focus:ring-teal-500 focus:border-teal-500">
                        </div>
                    </div>
                    <button id="generate-questions-btn" class="mt-4 py-2 px-4 bg-teal-500 text-white font-semibold rounded-lg shadow-md hover:bg-teal-600 transition-colors">✨Generate Interview Questions✨</button>
                    <div id="generated-questions-output" class="mt-4 p-4 bg-purple-50 border-l-4 border-purple-500 text-purple-800 rounded-r-lg hidden">
                        <p class="font-semibold">Generated Interview Questions:</p>
                        <div id="questions-content" class="mt-2 text-sm"></div>
                        <div id="questions-loading" class="text-center text-sm text-purple-600 hidden">Generating...</div>
                    </div>
                </div>
            </section>

            <section id="management" class="content-section">
                <h2 class="text-2xl font-bold text-teal-600 mb-4">Product Requirements Classification and Management</h2>
                <p class="mb-6 text-stone-600">After collecting numerous requirements, effective classification and management are crucial. This helps the team clarify direction and allocate resources reasonably. In this section, you'll practice classifying requirements through a drag-and-drop exercise, deepening your understanding of different requirement types, and learning about core requirement management activities.</p>
                <h3 class="text-xl font-semibold mb-3">Requirements Classification Exercise</h3>
                <p class="text-sm text-stone-500 mb-4">Drag the requirement cards from the left to the corresponding classification areas on the right.</p>
                <div class="grid md:grid-cols-3 gap-6">
                    <div class="md:col-span-1">
                        <h4 class="font-semibold text-center mb-2">Requirements Pool</h4>
                        <div id="requirements-pool" class="p-4 bg-stone-100 rounded-lg space-y-3 min-h-[300px]">
                        </div>
                    </div>
                    <div class="md:col-span-2">
                        <h4 class="font-semibold text-center mb-2">Requirement Classification</h4>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div id="functional-zone" class="drop-zone p-3 border-2 border-dashed border-stone-300 rounded-lg min-h-[150px]">
                                <h5 class="font-bold text-center text-sky-600 mb-2">Functional Requirements</h5>
                            </div>
                            <div id="non-functional-zone" class="drop-zone p-3 border-2 border-dashed border-stone-300 rounded-lg min-h-[150px]">
                                <h5 class="font-bold text-center text-amber-600 mb-2">Non-functional Requirements</h5>
                            </div>
                            <div id="business-zone" class="drop-zone p-3 border-2 border-dashed border-stone-300 rounded-lg min-h-[150px]">
                                <h5 class="font-bold text-center text-emerald-600 mb-2">Business Requirements</h5>
                            </div>
                            <div id="user-zone" class="drop-zone p-3 border-2 border-dashed border-stone-300 rounded-lg min-h-[150px]">
                                <h5 class="font-bold text-center text-violet-600 mb-2">User Requirements</h5>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="sort-feedback" class="mt-4 text-center font-medium"></div>
            </section>

            <section id="pmbok" class="content-section">
                <h2 class="text-2xl font-bold text-teal-600 mb-4">Connecting with PMBOK Knowledge Areas</h2>
                <p class="mb-6 text-stone-600">Product requirements management is not an isolated activity; it is closely linked to the core concepts within the Project Management Body of Knowledge (PMBOK). Understanding these connections helps product managers collaborate better with project teams and ensure successful product delivery. This section will clarify the relationship between requirements management and two key PMBOK performance domains.</p>
                <div class="grid md:grid-cols-2 gap-8">
                    <div class="bg-teal-50 p-6 rounded-lg">
                        <h3 class="text-xl font-semibold text-teal-700 mb-3">Stakeholder Performance Domain</h3>
                        <p class="text-stone-600">Understanding stakeholder needs is the cornerstone of project success. The requirements gathering process itself involves effective communication with stakeholders (e.g., users, clients, management) to identify and analyze their expectations and needs. Product managers need to identify all key stakeholders and manage their engagement and expectations, ensuring their voices are heard and incorporated into requirement considerations.</p>
                    </div>
                    <div class="bg-sky-50 p-6 rounded-lg">
                        <h3 class="text-xl font-semibold text-sky-700 mb-3">Delivery Performance Domain</h3>
                        <p class="text-stone-600">The 'deliverables' are the products or services built based on 'clear, accurate requirements.' The quality of requirements directly impacts the quality and efficiency of delivery. User stories and agile methodologies emphasize small, rapid iterations and continuous delivery of valuable features, which aligns perfectly with the goals of the delivery performance domain.</p>
                    </div>
                </div>
                 <div class="mt-8 bg-stone-100 p-6 rounded-lg">
                    <h3 class="text-xl font-semibold text-stone-700 mb-3">Data Collection and Analysis Methods</h3>
                    <p class="text-stone-600">The previously mentioned methods such as interviews, focus groups, questionnaires, and observation are commonly used 'data collection' tools and techniques in PMBOK. During the requirements gathering phase, product managers utilize these tools to 'analyze' and 'organize' raw information, ultimately forming structured product requirements.</p>
                </div>
            </section>

        </main>
    </div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    
    const navButtons = document.querySelectorAll('.nav-btn');
    const contentSections = document.querySelectorAll('.content-section');

    function switchTab(targetId) {
        navButtons.forEach(btn => {
            btn.classList.toggle('active', btn.dataset.target === targetId);
        });
        contentSections.forEach(section => {
            section.classList.toggle('active', section.id === targetId);
        });
    }

    navButtons.forEach(button => {
        button.addEventListener('click', () => {
            switchTab(button.dataset.target);
        });
    });

    // User Story Section
    const userRoleInput = document.getElementById('user-role');
    const userGoalInput = document.getElementById('user-goal');
    const userValueInput = document.getElementById('user-value');
    const generatedStoryDiv = document.getElementById('generated-story');
    const optimizeStoryBtn = document.getElementById('optimize-story-btn');
    const optimizationSuggestionsDiv = document.getElementById('optimization-suggestions');
    const optimizationContentDiv = document.getElementById('optimization-content');
    const optimizationLoadingDiv = document.getElementById('optimization-loading');

    function updateGeneratedStory() {
        const role = userRoleInput.value.trim() || '[User Role]';
        const goal = userGoalInput.value.trim() || '[Some Feature]';
        const value = userValueInput.value.trim() || '[Achieve Some Value]';
        generatedStoryDiv.innerHTML = `<p>As a <strong class="text-teal-600">${role}</strong>,</p><p>I want to <strong class="text-teal-600">${goal}</strong>,</p><p>so that <strong class="text-teal-600">${value}</strong>.</p>`;
    }

    [userRoleInput, userGoalInput, userValueInput].forEach(input => {
        input.addEventListener('input', updateGeneratedStory);
    });
    updateGeneratedStory();

    // Gemini API integration for User Story Optimization
    optimizeStoryBtn.addEventListener('click', async () => {
        const userStory = generatedStoryDiv.textContent.trim();
        if (!userStory || userStory.includes('[User Role]')) {
            optimizationSuggestionsDiv.classList.remove('hidden');
            optimizationContentDiv.textContent = 'Please complete the user story first.';
            return;
        }

        optimizationSuggestionsDiv.classList.remove('hidden');
        optimizationContentDiv.textContent = '';
        optimizationLoadingDiv.classList.remove('hidden');
        optimizeStoryBtn.disabled = true;

        const prompt = `Please provide improvement suggestions for the following user story based on the INVEST principles in agile development. Point out potential shortcomings and give specific optimization directions (e.g., how to make it more independent, estimable, valuable, etc.). Only provide suggestions, do not repeat the user story itself. User Story: "${userStory}"`;
        
        let chatHistory = [];
        chatHistory.push({ role: "user", parts: [{ text: prompt }] });
        const payload = { contents: chatHistory };
        const apiKey = ""; 
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

        let retries = 0;
        const maxRetries = 3;
        const baseDelay = 1000;

        while (retries < maxRetries) {
            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (response.status === 429) { // Too Many Requests
                    retries++;
                    const delay = baseDelay * Math.pow(2, retries - 1);
                    await new Promise(resolve => setTimeout(resolve, delay));
                    continue;
                }

                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    optimizationContentDiv.innerHTML = text.replace(/\n/g, '<br>');
                } else {
                    optimizationContentDiv.textContent = 'Failed to get optimization suggestions, please try again later.';
                }
                break; // Exit loop on success or non-retryable error
            } catch (error) {
                optimizationContentDiv.textContent = 'Request failed, please check your network or try again later.';
                break; // Exit loop on fetch error
            } finally {
                optimizationLoadingDiv.classList.add('hidden');
                optimizeStoryBtn.disabled = false;
            }
        }
        if (retries === maxRetries) {
            optimizationContentDiv.textContent = 'Request timed out, please try again later.';
            optimizationLoadingDiv.classList.add('hidden');
            optimizeStoryBtn.disabled = false;
        }
    });


    // 3C Chart
    new Chart(document.getElementById('3c-chart'), {
        type: 'doughnut',
        data: {
            labels: ['Card', 'Conversation', 'Confirmation'],
            datasets: [{
                data: [1, 1, 1],
                backgroundColor: ['#14b8a6', '#f59e0b', '#3b82f6'],
                borderColor: '#ffffff',
                borderWidth: 4,
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom',
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            return context.label;
                        }
                    }
                }
            }
        }
    });

    // INVEST Accordion
    const investData = [
        { name: 'Independent', desc: 'Minimally dependent on other stories.' },
        { name: 'Negotiable', desc: 'Details can be negotiated with the team during development.' },
        { name: 'Valuable', desc: 'Provides clear value to the user or business.' },
        { name: 'Estimable', desc: 'The team can roughly estimate the effort required.' },
        { name: 'Small', desc: 'Small enough to be completed within one iteration.' },
        { name: 'Testable', desc: 'Has clear acceptance criteria and can be tested.' }
    ];
    const investAccordion = document.getElementById('invest-accordion');
    investData.forEach(item => {
        const div = document.createElement('div');
        div.className = 'border border-stone-200 rounded-md';
        div.innerHTML = `
            <button class="w-full text-left p-3 font-medium flex justify-between items-center">
                <span>${item.name}</span>
                <span class="transform transition-transform text-teal-500">+</span>
            </button>
            <div class="px-3 pb-3 text-stone-600 text-sm hidden">
                ${item.desc}
            </div>
        `;
        investAccordion.appendChild(div);
    });

    investAccordion.addEventListener('click', (e) => {
        const button = e.target.closest('button');
        if (button) {
            const content = button.nextElementSibling;
            const icon = button.querySelector('span:last-child');
            const isHidden = content.classList.toggle('hidden');
            icon.textContent = isHidden ? '+' : '-';
            icon.classList.toggle('rotate-45', !isHidden);
        }
    });

    // Gathering Section
    const gatheringMethodsData = [
        { name: 'Interviews', breadth: 2, depth: 9, desc: 'In-depth one-on-one conversations to gain detailed insights and deep motivations.' },
        { name: 'Focus Groups', breadth: 4, depth: 7, desc: 'Group discussions to gather collective opinions and consensus.' },
        { name: 'Surveys', breadth: 10, depth: 3, desc: 'Large-scale data collection for quantitative analysis of user preferences.' },
        { name: 'Observation', breadth: 3, depth: 8, desc: 'Directly observing user behavior in real environments.' },
        { name: 'Competitor Analysis', breadth: 6, depth: 5, desc: 'Learning from competitors\' products to find opportunities.' },
        { name: 'Document Analysis', breadth: 5, depth: 4, desc: 'Analyzing existing business processes, regulations, etc.' },
        { name: 'Prototyping', breadth: 3, depth: 6, desc: 'Obtaining feedback through user testing of prototypes.' }
    ];
    const methodCardsContainer = document.getElementById('method-cards-container');
    gatheringMethodsData.forEach(method => {
        const card = document.createElement('div');
        card.className = 'interactive-card p-4 bg-stone-100 rounded-lg text-center';
        card.innerHTML = `<h4 class="font-semibold">${method.name}</h4><p class="text-xs text-stone-500 mt-1">${method.desc}</p>`;
        methodCardsContainer.appendChild(card);
    });

    new Chart(document.getElementById('gathering-methods-chart'), {
        type: 'bar',
        data: {
            labels: gatheringMethodsData.map(m => m.name),
            datasets: [
                {
                    label: 'Data Breadth',
                    data: gatheringMethodsData.map(m => m.breadth),
                    backgroundColor: 'rgba(59, 130, 246, 0.6)',
                    borderColor: 'rgba(59, 130, 246, 1)',
                    borderWidth: 1
                },
                {
                    label: 'Data Depth',
                    data: gatheringMethodsData.map(m => m.depth),
                    backgroundColor: 'rgba(245, 158, 11, 0.6)',
                    borderColor: 'rgba(245, 158, 11, 1)',
                    borderWidth: 1
                }
            ]
        },
        options: {
            indexAxis: 'y',
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                x: {
                    stacked: true,
                    title: { display: true, text: 'Relative Index' }
                },
                y: {
                    stacked: true
                }
            },
            plugins: {
                legend: { position: 'top' }
            }
        }
    });

    // Gemini API integration for Interview Question Generator
    const productTopicInput = document.getElementById('product-topic');
    const interviewUserRoleInput = document.getElementById('interview-user-role');
    const generateQuestionsBtn = document.getElementById('generate-questions-btn');
    const generatedQuestionsOutputDiv = document.getElementById('generated-questions-output');
    const questionsContentDiv = document.getElementById('questions-content');
    const questionsLoadingDiv = document.getElementById('questions-loading');

    generateQuestionsBtn.addEventListener('click', async () => {
        const productTopic = productTopicInput.value.trim();
        const userRole = interviewUserRoleInput.value.trim();

        if (!productTopic || !userRole) {
            generatedQuestionsOutputDiv.classList.remove('hidden');
            questionsContentDiv.textContent = 'Please fill in both product topic and user role.';
            return;
        }

        generatedQuestionsOutputDiv.classList.remove('hidden');
        questionsContentDiv.textContent = '';
        questionsLoadingDiv.classList.remove('hidden');
        generateQuestionsBtn.disabled = true;

        const prompt = `For a product about "${productTopic}", targeting the user role of "${userRole}", generate 5-7 in-depth interview questions to help a product manager gather genuine requirements and pain points. Questions should be specific, open-ended, and encourage the user to share experiences and feelings.`;
        
        let chatHistory = [];
        chatHistory.push({ role: "user", parts: [{ text: prompt }] });
        const payload = { contents: chatHistory };
        const apiKey = ""; 
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

        let retries = 0;
        const maxRetries = 3;
        const baseDelay = 1000;

        while (retries < maxRetries) {
            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (response.status === 429) { 
                    retries++;
                    const delay = baseDelay * Math.pow(2, retries - 1);
                    await new Promise(resolve => setTimeout(resolve, delay));
                    continue;
                }

                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    questionsContentDiv.innerHTML = text.replace(/\n/g, '<br>');
                } else {
                    questionsContentDiv.textContent = 'Failed to generate interview questions, please try again later.';
                }
                break; 
            } catch (error) {
                questionsContentDiv.textContent = 'Request failed, please check your network or try again later.';
                break; 
            } finally {
                questionsLoadingDiv.classList.add('hidden');
                generateQuestionsBtn.disabled = false;
            }
        }
        if (retries === maxRetries) {
            questionsContentDiv.textContent = 'Request timed out, please try again later.';
            questionsLoadingDiv.classList.add('hidden');
            generateQuestionsBtn.disabled = false;
        }
    });
    
    // Management Section - Drag and Drop
    const requirements = [
        { id: 'req1', text: 'Users should be able to register with email', type: 'functional' },
        { id: 'req2', text: 'Website loading time should be less than 2 seconds', type: 'non-functional' },
        { id: 'req3', text: 'Increase Q1 user retention by 5%', type: 'business' },
        { id: 'req4', text: 'I want to easily find courses', type: 'user' },
        { id: 'req5', text: 'Implement product payment functionality', type: 'functional' },
        { id: 'req6', text: 'System must be compatible with mainstream browsers', type: 'non-functional' },
    ];
    const pool = document.getElementById('requirements-pool');
    const dropZones = document.querySelectorAll('.drop-zone');
    const feedbackDiv = document.getElementById('sort-feedback');
    let draggedItem = null;

    function initializeSorter() {
        pool.innerHTML = '';
        dropZones.forEach(zone => {
            const title = zone.querySelector('h5');
            zone.innerHTML = '';
            zone.appendChild(title);
        });
        feedbackDiv.textContent = '';
        requirements.forEach(req => {
            const div = document.createElement('div');
            div.id = req.id;
            div.dataset.type = req.type;
            div.className = 'sortable-item p-3 bg-white rounded-md shadow-sm text-sm';
            div.textContent = req.text;
            div.draggable = true;
            pool.appendChild(div);
        });
    }

    document.addEventListener('dragstart', (e) => {
        if (e.target.classList.contains('sortable-item')) {
            draggedItem = e.target;
            setTimeout(() => e.target.style.display = 'none', 0);
        }
    });
    
    document.addEventListener('dragend', (e) => {
        if (draggedItem) {
            setTimeout(() => {
                draggedItem.style.display = 'block';
                draggedItem = null;
            }, 0);
        }
    });

    dropZones.forEach(zone => {
        zone.addEventListener('dragover', e => {
            e.preventDefault();
            zone.classList.add('over');
        });
        zone.addEventListener('dragleave', e => {
            zone.classList.remove('over');
        });
        zone.addEventListener('drop', e => {
            e.preventDefault();
            zone.classList.remove('over');
            if (draggedItem) {
                const correctType = draggedItem.dataset.type;
                const zoneType = zone.id.split('-')[0];
                if (correctType === zoneType) {
                    draggedItem.style.backgroundColor = '#d1fae5'; // green-100
                    feedbackDiv.textContent = 'Correct! Classification successful.';
                    feedbackDiv.className = 'mt-4 text-center font-medium text-emerald-600';
                } else {
                    draggedItem.style.backgroundColor = '#fee2e2'; // red-100
                    feedbackDiv.textContent = `Incorrect, this is more like a “${correctType.charAt(0).toUpperCase() + correctType.slice(1)}” requirement.`;
                    feedbackDiv.className = 'mt-4 text-center font-medium text-red-600';
                }
                zone.appendChild(draggedItem);
                
                if (pool.children.length === 0) {
                    setTimeout(() => {
                        feedbackDiv.textContent = 'Congratulations! You have classified all. Resetting for you.';
                        setTimeout(initializeSorter, 2000);
                    }, 1000);
                }
            }
        });
    });

    initializeSorter();
});
</script>

</body>
</html>
